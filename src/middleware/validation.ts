import { Request, Response, NextFunction } from \"express\";\n\n// Simple runtime schema type: boolean flags indicate required primitive fields;\n// nested objects are supported via nested ValidationSchema objects.\nexport type ValidationSchema = {\n  [key: string]: boolean | ValidationSchema;\n};\n\n/**\n * Creates an Express middleware that validates req.body against a simple runtime schema.\n * - Primitives marked as true are required.\n * - Nested objects are validated recursively.\n */\nexport const buildValidationMiddleware = (schema: ValidationSchema) => {\n  return (req: Request, res: Response, next: NextFunction) => {\n    const errors: string[] = [];\n\n    const walk = (obj: any, sch: ValidationSchema, path: string) => {\n      for (const key of Object.keys(sch)) {\n        const rule = (sch as any)[key];\n        const exists = obj != null && Object.prototype.hasOwnProperty.call(obj, key);\n        const currentPath = path ? `${path}.${key}` : key;\n\n        if (rule === true) {\n          if (!exists) {\n            errors.push(`Missing required field: ${currentPath}`);\n          }\n        } else if (rule && typeof rule === \"object\") {\n          if (!exists) {\n            errors.push(`Missing required object: ${currentPath}`);\n          } else {\n            walk(obj[key], rule as ValidationSchema, currentPath);\n          }\n        }\n      }\n    };\n\n    walk(req.body, schema, \"\");\n\n    if (errors.length > 0) {\n      res.status(400).json({ errors });\n      return;\n    }\n    next();\n  };\n};\n\nexport const validateBody = buildValidationMiddleware;\n\nexport default buildValidationMiddleware;\n